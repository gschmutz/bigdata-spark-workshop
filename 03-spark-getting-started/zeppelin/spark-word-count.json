{"paragraphs":[{"text":"%md # Spark Getting Started with the Spark Wordcount using Resilient Distributed Datasets (RDD) and Spark DataFrames\n","user":"admin","dateUpdated":"2020-05-18T17:59:23+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Spark Getting Started with the Spark Wordcount using Resilient Distributed Datasets (RDD) and Spark DataFrames</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1589824725061_1731078074","id":"20200518-175845_834541067","dateCreated":"2020-05-18T17:58:45+0000","dateStarted":"2020-05-18T17:59:23+0000","dateFinished":"2020-05-18T17:59:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:18860"},{"title":"Check for the data","text":"%sh\ns3cmd ls -r s3://wordcount-bucket/raw-data","user":"admin","dateUpdated":"2020-05-18T17:58:44+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"2020-05-18 17:39      6488666  s3://wordcount-bucket/raw-data/big.txt\n"}]},"apps":[],"jobName":"paragraph_1589824683014_-1458001291","id":"20200518-175803_2038737979","dateCreated":"2020-05-18T17:58:03+0000","dateStarted":"2020-05-18T17:58:42+0000","dateFinished":"2020-05-18T17:58:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18861"},{"text":"%md ## Spark Wordcount using Resilient Distributed Datasets (RDDs)\n","user":"admin","dateUpdated":"2020-05-18T16:51:58+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Spark Wordcount using Resilient Distributed Datasets (RDDs)</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1589820667347_-1886877331","id":"20200518-165107_438204899","dateCreated":"2020-05-18T16:51:07+0000","dateStarted":"2020-05-18T16:51:58+0000","dateFinished":"2020-05-18T16:51:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18862"},{"text":"%pyspark\nlines = sc.textFile(\"s3a://namenode:9000/user/hue/wordcount/big.txt\")","user":"admin","dateUpdated":"2020-05-18T17:38:15+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1589820657568_1478277326","id":"20190526-111936_1173697145","dateCreated":"2020-05-18T16:50:57+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18863"},{"text":"%pyspark\nlines = sc.textFile(\"s3a://wordcount-bucket/raw-data/big.txt\")\nlines","user":"admin","dateUpdated":"2020-05-18T18:29:01+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"s3a://wordcount-bucket/raw-data/big.txt MapPartitionsRDD[152] at textFile at NativeMethodAccessorImpl.java:0\n"}]},"apps":[],"jobName":"paragraph_1589823524360_-446092366","id":"20200518-173844_887544576","dateCreated":"2020-05-18T17:38:44+0000","dateStarted":"2020-05-18T18:29:01+0000","dateFinished":"2020-05-18T18:29:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18864"},{"text":"%pyspark\nlines.take(10)","user":"admin","dateUpdated":"2020-05-18T18:29:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['The Project Gutenberg EBook of The Adventures of Sherlock Holmes', 'by Sir Arthur Conan Doyle', '(#15 in our series by Sir Arthur Conan Doyle)', '', 'Copyright laws are changing all over the world. Be sure to check the', 'copyright laws for your country before downloading or redistributing', 'this or any other Project Gutenberg eBook.', '', 'This header should be the first thing seen when viewing this Project', 'Gutenberg file.  Please do not remove it.  Do not change or edit the']\n"}]},"apps":[],"jobName":"paragraph_1589824360979_-349608018","id":"20200518-175240_46374484","dateCreated":"2020-05-18T17:52:40+0000","dateStarted":"2020-05-18T18:29:03+0000","dateFinished":"2020-05-18T18:29:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18865"},{"text":"%pyspark\nlinesAndWords = lines.map(lambda line: line.split(\" \"))\nlinesAndWords\n","user":"admin","dateUpdated":"2020-05-18T18:29:05+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"PythonRDD[154] at RDD at PythonRDD.scala:53\n"}]},"apps":[],"jobName":"paragraph_1589820657568_-874364090","id":"20190526-112258_1234595247","dateCreated":"2020-05-18T16:50:57+0000","dateStarted":"2020-05-18T18:29:05+0000","dateFinished":"2020-05-18T18:29:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18866"},{"text":"%pyspark\nlinesAndWords.take(10)","user":"admin","dateUpdated":"2020-05-18T18:29:09+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[['The', 'Project', 'Gutenberg', 'EBook', 'of', 'The', 'Adventures', 'of', 'Sherlock', 'Holmes'], ['by', 'Sir', 'Arthur', 'Conan', 'Doyle'], ['(#15', 'in', 'our', 'series', 'by', 'Sir', 'Arthur', 'Conan', 'Doyle)'], [''], ['Copyright', 'laws', 'are', 'changing', 'all', 'over', 'the', 'world.', 'Be', 'sure', 'to', 'check', 'the'], ['copyright', 'laws', 'for', 'your', 'country', 'before', 'downloading', 'or', 'redistributing'], ['this', 'or', 'any', 'other', 'Project', 'Gutenberg', 'eBook.'], [''], ['This', 'header', 'should', 'be', 'the', 'first', 'thing', 'seen', 'when', 'viewing', 'this', 'Project'], ['Gutenberg', 'file.', '', 'Please', 'do', 'not', 'remove', 'it.', '', 'Do', 'not', 'change', 'or', 'edit', 'the']]\n"}]},"apps":[],"jobName":"paragraph_1589826148052_1996809659","id":"20200518-182228_1390045510","dateCreated":"2020-05-18T18:22:28+0000","dateStarted":"2020-05-18T18:29:09+0000","dateFinished":"2020-05-18T18:29:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18867"},{"text":"%pyspark\nwords = linesAndWords.flatMap(lambda line: line)\nwords","user":"admin","dateUpdated":"2020-05-18T18:29:13+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"PythonRDD[156] at RDD at PythonRDD.scala:53\n"}]},"apps":[],"jobName":"paragraph_1589826124541_-94002460","id":"20200518-182204_1281039414","dateCreated":"2020-05-18T18:22:04+0000","dateStarted":"2020-05-18T18:29:13+0000","dateFinished":"2020-05-18T18:29:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18868"},{"text":"%pyspark\nwords.take(10)","user":"admin","dateUpdated":"2020-05-18T18:29:15+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['The', 'Project', 'Gutenberg', 'EBook', 'of', 'The', 'Adventures', 'of', 'Sherlock', 'Holmes']\n"}]},"apps":[],"jobName":"paragraph_1589824328042_-1847287474","id":"20200518-175208_379739701","dateCreated":"2020-05-18T17:52:08+0000","dateStarted":"2020-05-18T18:29:15+0000","dateFinished":"2020-05-18T18:29:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18869"},{"text":"%pyspark\nwordsAndOne = words.map(lambda word: (word,1))\nwordsAndOne\n","user":"admin","dateUpdated":"2020-05-18T18:29:23+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"PythonRDD[158] at RDD at PythonRDD.scala:53\n"}]},"apps":[],"jobName":"paragraph_1589820657569_-1427338439","id":"20190526-113109_1190767150","dateCreated":"2020-05-18T16:50:57+0000","dateStarted":"2020-05-18T18:29:23+0000","dateFinished":"2020-05-18T18:29:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18870"},{"text":"%pyspark\nwordsAndOne.take(10)","user":"admin","dateUpdated":"2020-05-18T17:57:38+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('The', 1), ('Project', 1), ('Gutenberg', 1), ('EBook', 1), ('of', 1), ('The', 1), ('Adventures', 1), ('of', 1), ('Sherlock', 1), ('Holmes', 1)]\n"}]},"apps":[],"jobName":"paragraph_1589824647869_293094273","id":"20200518-175727_349831255","dateCreated":"2020-05-18T17:57:27+0000","dateStarted":"2020-05-18T17:57:38+0000","dateFinished":"2020-05-18T17:57:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18871"},{"text":"%pyspark\ncounts = wordsAndOne.reduceByKey(lambda a, b : a + b)\ncounts","user":"admin","dateUpdated":"2020-05-18T17:57:43+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"PythonRDD[124] at RDD at PythonRDD.scala:53\n"}]},"apps":[],"jobName":"paragraph_1589823621410_-1991588505","id":"20200518-174021_1482718084","dateCreated":"2020-05-18T17:40:21+0000","dateStarted":"2020-05-18T17:57:43+0000","dateFinished":"2020-05-18T17:57:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18872"},{"text":"%pyspark\ncounts.take(10)","user":"admin","dateUpdated":"2020-05-18T18:38:15+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"1":{"graph":{"mode":"table","height":300,"optionOpen":false}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('footman', 35), ('dressed', 73), ('in', 19515), ('knee', 53), ('shoes,', 16), ('swallow-tail', 6), ('ran', 307), ('looked', 750), ('', 69285), ('The', 6139)]\n"}]},"apps":[],"jobName":"paragraph_1589824665588_-1915058863","id":"20200518-175745_1021573760","dateCreated":"2020-05-18T17:57:45+0000","dateStarted":"2020-05-18T18:38:15+0000","dateFinished":"2020-05-18T18:38:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18873"},{"text":"%pyspark\n#counts.saveAsTextFile(\"hdfs://namenode:9000/user/hue/wordcount/result\")\ncounts.saveAsTextFile(\"s3a://wordcount-bucket/result-data\")\n","user":"admin","dateUpdated":"2020-05-18T17:41:17+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1589820657569_506125257","id":"20190526-113115_1825852289","dateCreated":"2020-05-18T16:50:57+0000","dateStarted":"2020-05-18T17:41:17+0000","dateFinished":"2020-05-18T17:41:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18874"},{"text":"%pyspark\nlines = sc.textFile(\"s3a://wordcount-bucket/raw-data/big.txt\")\nwords = lines.flatMap(lambda line: line.split(\" \"))\nwordsAndOne = words.map(lambda word: (word,1))\ncounts = wordsAndOne.reduceByKey(lambda a, b : a + b)\ncounts.take(10)","user":"admin","dateUpdated":"2020-05-18T18:49:52+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('The', 6139), ('Project', 205), ('EBook', 5), ('of', 39169), ('Sir', 30), ('Arthur', 18), ('Conan', 3), ('in', 19515), ('series', 88), ('', 69285)]\n"}]},"apps":[],"jobName":"paragraph_1589827511244_474757235","id":"20200518-184511_1196352893","dateCreated":"2020-05-18T18:45:11+0000","dateStarted":"2020-05-18T18:49:52+0000","dateFinished":"2020-05-18T18:50:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18875"},{"text":"%pyspark\ncounts = sc.textFile(\"s3a://wordcount-bucket/raw-data/big.txt\") \\\n            .flatMap(lambda line: line.split(\" \")) \\\n            .map(lambda word: (word,1)) \\\n            .reduceByKey(lambda a, b : a + b)\ncounts.take(10)","user":"admin","dateUpdated":"2020-05-18T18:53:04+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('The', 6139), ('Project', 205), ('EBook', 5), ('of', 39169), ('Sir', 30), ('Arthur', 18), ('Conan', 3), ('in', 19515), ('series', 88), ('', 69285)]\n"}]},"apps":[],"jobName":"paragraph_1589827653989_-1883429590","id":"20200518-184733_1226547339","dateCreated":"2020-05-18T18:47:33+0000","dateStarted":"2020-05-18T18:53:04+0000","dateFinished":"2020-05-18T18:53:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18876"},{"text":"%pyspark\ncounts.count()","user":"admin","dateUpdated":"2020-05-18T16:50:57+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"81410\n"}]},"apps":[],"jobName":"paragraph_1589820657570_1459377994","id":"20190526-113123_1697605617","dateCreated":"2020-05-18T16:50:57+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18877"},{"text":"%md ## Spark Wordcount using DataFrames\n","user":"admin","dateUpdated":"2020-05-18T16:51:56+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"results":{},"enabled":true,"editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Spark Wordcount using DataFrames</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1589820657570_1618442785","id":"20190526-113042_869867834","dateCreated":"2020-05-18T16:50:57+0000","dateStarted":"2020-05-18T16:51:56+0000","dateFinished":"2020-05-18T16:51:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18878"},{"title":"Reading data is done with spark.read which is part of DataFrameReader","text":"%pyspark\nspark.read","user":"admin","dateUpdated":"2020-05-18T18:00:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<pyspark.sql.readwriter.DataFrameReader object at 0x7fc1fc2785d0>\n"}]},"apps":[],"jobName":"paragraph_1589820716306_-1337088918","id":"20200518-165156_440548441","dateCreated":"2020-05-18T16:51:56+0000","dateStarted":"2020-05-18T16:52:13+0000","dateFinished":"2020-05-18T16:52:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18879"},{"title":"Display methods it exposes, such as text(), json(), ...","text":"%pyspark\ndir (spark.read)","user":"admin","dateUpdated":"2020-05-18T18:01:06+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', '_df', '_jreader', '_set_opts', '_spark', 'csv', 'format', 'jdbc', 'json', 'load', 'option', 'options', 'orc', 'parquet', 'schema', 'table', 'text']\n"}]},"apps":[],"jobName":"paragraph_1589820733059_-1850237601","id":"20200518-165213_2076782577","dateCreated":"2020-05-18T16:52:13+0000","dateStarted":"2020-05-18T18:00:33+0000","dateFinished":"2020-05-18T18:00:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18880"},{"title":"Use text to read plain text and a DataFrame of string is returned","text":"%pyspark\nbookDF = spark.read.text(\"s3a://wordcount-bucket/raw-data/big.txt\")\nbookDF","user":"admin","dateUpdated":"2020-05-18T20:24:04+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DataFrame[value: string]\n"}]},"apps":[],"jobName":"paragraph_1589823456914_1259056906","id":"20200518-173736_1635582827","dateCreated":"2020-05-18T17:37:36+0000","dateStarted":"2020-05-18T20:23:49+0000","dateFinished":"2020-05-18T20:23:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18881"},{"title":"Let's display the schema in more readable way","text":"%pyspark\nbookDF.printSchema()","user":"admin","dateUpdated":"2020-05-18T20:25:07+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- value: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1589823716014_-986455450","id":"20200518-174156_854280327","dateCreated":"2020-05-18T17:41:56+0000","dateStarted":"2020-05-18T20:25:07+0000","dateFinished":"2020-05-18T20:25:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18883"},{"title":"Show a sample of the dat, by default 20 rows","text":"%pyspark\nbookDF.show()","user":"admin","dateUpdated":"2020-05-18T20:25:17+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+\n|               value|\n+--------------------+\n|The Project Guten...|\n|by Sir Arthur Con...|\n|(#15 in our serie...|\n|                    |\n|Copyright laws ar...|\n|copyright laws fo...|\n|this or any other...|\n|                    |\n|This header shoul...|\n|Gutenberg file.  ...|\n|header without wr...|\n|                    |\n|Please read the \"...|\n|eBook and Project...|\n|important informa...|\n|how the file may ...|\n|donation to Proje...|\n|                    |\n|                    |\n|**Welcome To The ...|\n+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1589823729332_-1866604205","id":"20200518-174209_1123172832","dateCreated":"2020-05-18T17:42:09+0000","dateStarted":"2020-05-18T20:25:17+0000","dateFinished":"2020-05-18T20:25:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18884"},{"title":"Show a sample of 10 rows, truncating them to 50 characters ","text":"%pyspark\nbookDF.show(10, truncate=50)","user":"admin","dateUpdated":"2020-05-18T20:27:09+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------------------------------------+\n|                                             value|\n+--------------------------------------------------+\n|The Project Gutenberg EBook of The Adventures o...|\n|                         by Sir Arthur Conan Doyle|\n|     (#15 in our series by Sir Arthur Conan Doyle)|\n|                                                  |\n|Copyright laws are changing all over the world....|\n|copyright laws for your country before download...|\n|        this or any other Project Gutenberg eBook.|\n|                                                  |\n|This header should be the first thing seen when...|\n|Gutenberg file.  Please do not remove it.  Do n...|\n+--------------------------------------------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1589823747257_-648333497","id":"20200518-174227_1091238933","dateCreated":"2020-05-18T17:42:27+0000","dateStarted":"2020-05-18T20:27:09+0000","dateFinished":"2020-05-18T20:27:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18885"},{"title":"To tokenize each word, we need to split each string into a list of distinct words, using a single space character to split","text":"%pyspark\nfrom pyspark.sql.functions import split\n\nlinesDF = bookDF.select(split(bookDF.value, \" \").alias(\"line\"))\nlinesDF.show(5)","user":"admin","dateUpdated":"2020-05-18T20:34:22+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+\n|                line|\n+--------------------+\n|[The, Project, Gu...|\n|[by, Sir, Arthur,...|\n|[(#15, in, our, s...|\n|                  []|\n|[Copyright, laws,...|\n+--------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1589823801379_-1127524416","id":"20200518-174321_96996376","dateCreated":"2020-05-18T17:43:21+0000","dateStarted":"2020-05-18T20:27:27+0000","dateFinished":"2020-05-18T20:27:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18886"},{"title":"Selecting a specific colum using select()","text":"%pyspark\nbookDF.select(bookDF.value)","user":"admin","dateUpdated":"2020-05-18T20:28:38+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DataFrame[value: string]\n"}]},"apps":[],"jobName":"paragraph_1589823824149_-238101602","id":"20200518-174344_537415683","dateCreated":"2020-05-18T17:43:44+0000","dateStarted":"2020-05-18T20:28:38+0000","dateFinished":"2020-05-18T20:28:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18887"},{"title":"Alternative ways to select a column","text":"%pyspark\nfrom pyspark.sql.functions import col\n\nbookDF.select(bookDF.value) \nbookDF.select(bookDF[\"value\"]) \nbookDF.select(col(\"value\"))","user":"admin","dateUpdated":"2020-05-18T20:28:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DataFrame[value: string]\n"}]},"apps":[],"jobName":"paragraph_1589823838293_191356838","id":"20200518-174358_421875708","dateCreated":"2020-05-18T17:43:58+0000","dateStarted":"2020-05-18T20:28:51+0000","dateFinished":"2020-05-18T20:28:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18888"},{"title":"print the schema","text":"%pyspark\nlinesDF.printSchema()","user":"admin","dateUpdated":"2020-05-18T20:38:32+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- line: array (nullable = true)\n |    |-- element: string (containsNull = true)\n\n"}]},"apps":[],"jobName":"paragraph_1589823880975_-660277302","id":"20200518-174440_208374350","dateCreated":"2020-05-18T17:44:40+0000","dateStarted":"2020-05-18T20:37:27+0000","dateFinished":"2020-05-18T20:37:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18890"},{"title":"Now we can use the line column and reshape it by exploding the list into rows","text":"%pyspark\nfrom pyspark.sql.functions import explode, col\n\nwordsDF = linesDF.select(explode(col(\"line\")).alias(\"word\"))\nwordsDF.show(15)","user":"admin","dateUpdated":"2020-05-18T20:38:47+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+\n|      word|\n+----------+\n|       The|\n|   Project|\n| Gutenberg|\n|     EBook|\n|        of|\n|       The|\n|Adventures|\n|        of|\n|  Sherlock|\n|    Holmes|\n|        by|\n|       Sir|\n|    Arthur|\n|     Conan|\n|     Doyle|\n+----------+\nonly showing top 15 rows\n\n"}]},"apps":[],"jobName":"paragraph_1589823973473_-1322083925","id":"20200518-174613_5383299","dateCreated":"2020-05-18T17:46:13+0000","dateStarted":"2020-05-18T20:38:47+0000","dateFinished":"2020-05-18T20:38:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18893"},{"title":"Change case to all lowercase","text":"%pyspark\nfrom pyspark.sql.functions import lower \nwordsLowerDF = wordsDF.select(lower(col(\"word\")).alias(\"word_lower\"))\n\nwordsLowerDF.show()","user":"admin","dateUpdated":"2020-05-18T20:40:35+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+\n|word_lower|\n+----------+\n|       the|\n|   project|\n| gutenberg|\n|     ebook|\n|        of|\n|       the|\n|adventures|\n|        of|\n|  sherlock|\n|    holmes|\n|        by|\n|       sir|\n|    arthur|\n|     conan|\n|     doyle|\n|      (#15|\n|        in|\n|       our|\n|    series|\n|        by|\n+----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1589824024738_1393963512","id":"20200518-174704_1249179179","dateCreated":"2020-05-18T17:47:04+0000","dateStarted":"2020-05-18T20:40:35+0000","dateFinished":"2020-05-18T20:40:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18894"},{"title":"Using regexp_extract to only keep what looks like a word","text":"%pyspark\nfrom pyspark.sql.functions import regexp_extract \nwordsCleanDF = wordsLowerDF.select( regexp_extract(col(\"word_lower\"), \"[a-z]*\", 0).alias(\"word\") )\n\nwordsCleanDF.show()","user":"admin","dateUpdated":"2020-05-18T20:41:17+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+\n|      word|\n+----------+\n|       the|\n|   project|\n| gutenberg|\n|     ebook|\n|        of|\n|       the|\n|adventures|\n|        of|\n|  sherlock|\n|    holmes|\n|        by|\n|       sir|\n|    arthur|\n|     conan|\n|     doyle|\n|          |\n|        in|\n|       our|\n|    series|\n|        by|\n+----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1589824042326_-1442440950","id":"20200518-174722_281675159","dateCreated":"2020-05-18T17:47:22+0000","dateStarted":"2020-05-18T20:41:17+0000","dateFinished":"2020-05-18T20:41:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18895"},{"title":"Filter rows that are empty","text":"%pyspark\nwordsNonNullDF = wordsCleanDF.where(col(\"word\") != \"\")\n\nwordsNonNullDF.show()","user":"admin","dateUpdated":"2020-05-18T20:44:21+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+\n|      word|\n+----------+\n|       the|\n|   project|\n| gutenberg|\n|     ebook|\n|        of|\n|       the|\n|adventures|\n|        of|\n|  sherlock|\n|    holmes|\n|        by|\n|       sir|\n|    arthur|\n|     conan|\n|     doyle|\n|        in|\n|       our|\n|    series|\n|        by|\n|       sir|\n+----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1589824068367_-1388487334","id":"20200518-174748_355120738","dateCreated":"2020-05-18T17:47:48+0000","dateStarted":"2020-05-18T20:44:21+0000","dateFinished":"2020-05-18T20:44:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18896"},{"title":"Counting word frequencies using groupby() ","text":"%pyspark\ngroupsDF = wordsNonNullDF.groupby(col(\"word\"))\n\ngroupsDF\n\n\n","user":"admin","dateUpdated":"2020-05-18T20:44:24+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<pyspark.sql.group.GroupedData object at 0x7fc0b58b8e50>\n"}]},"apps":[],"jobName":"paragraph_1589824114461_-518299179","id":"20200518-174834_1399709700","dateCreated":"2020-05-18T17:48:34+0000","dateStarted":"2020-05-18T20:44:24+0000","dateFinished":"2020-05-18T20:44:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18897"},{"title":"and count()","text":"%pyspark\nresultsDF = wordsNonNullDF.groupby(col(\"word\")).count()\nresultsDF\n","user":"admin","dateUpdated":"2020-05-18T20:44:34+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DataFrame[word: string, count: bigint]\n"}]},"apps":[],"jobName":"paragraph_1589824158115_-749050511","id":"20200518-174918_1870296873","dateCreated":"2020-05-18T17:49:18+0000","dateStarted":"2020-05-18T20:44:34+0000","dateFinished":"2020-05-18T20:44:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18898"},{"text":"%pyspark\nresultsDF.show()","user":"admin","dateUpdated":"2020-05-18T20:44:57+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+-----+\n|        word|count|\n+------------+-----+\n|    everyday|   14|\n|         few|  458|\n|       still|  896|\n|        some| 1517|\n|      doubts|   39|\n|       those| 1178|\n|   recognize|   54|\n|      poetry|   10|\n|      vortex|    2|\n|     embrace|   17|\n|       spoil|   10|\n|     blossom|    5|\n|   arguments|   38|\n|   connected|   52|\n|   imitation|    7|\n|     courted|    3|\n|        hope|  149|\n| formalities|    6|\n|vicissitudes|    3|\n|       inner|   60|\n+------------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1589824215731_-918092742","id":"20200518-175015_1795604915","dateCreated":"2020-05-18T17:50:15+0000","dateStarted":"2020-05-18T17:50:23+0000","dateFinished":"2020-05-18T17:50:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18899"},{"title":"Finally order the counts in descending order and only show the top 10 word counts","text":"%pyspark\nresultsDF.orderBy(\"count\", ascending=False).show(10)","user":"admin","dateUpdated":"2020-05-18T20:45:53+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-----+\n|word|count|\n+----+-----+\n| the|78176|\n|  of|39956|\n| and|37619|\n|  to|28550|\n|  in|21669|\n|   a|20666|\n|that|12102|\n|  he|12047|\n| was|11346|\n|  it|10170|\n+----+-----+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1589824223639_640657577","id":"20200518-175023_70603665","dateCreated":"2020-05-18T17:50:23+0000","dateStarted":"2020-05-18T17:51:04+0000","dateFinished":"2020-05-18T17:51:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:18900"},{"text":"%pyspark\n","user":"admin","dateUpdated":"2020-05-18T17:51:04+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1589824264705_563089175","id":"20200518-175104_279346841","dateCreated":"2020-05-18T17:51:04+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:18901"}],"name":"spark-word-count","id":"2FATGCP79","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}